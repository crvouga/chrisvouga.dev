# GitHub Secrets Configuration Guide

This guide explains how to obtain and configure the required GitHub Secrets for deployment.

**Note:** SSH keys are automatically generated by GitHub Actions - you don't need to create or manage them manually!

## Required GitHub Secrets

### 1. DO_TOKEN (Required) ⚠️ CRITICAL
**What it is:** Digital Ocean API token for provisioning infrastructure

**How to get it:**
1. Go to https://cloud.digitalocean.com/account/api/tokens
2. Click "Generate New Token"
3. Give it a name (e.g., "github-actions-terraform")
4. **IMPORTANT:** Select **"Write"** scope (not Read-only!)
5. Copy the token immediately (you won't see it again!)
6. Make sure the token is the full token string (starts with `dop_v1_` or `dop_`)

**Set in GitHub:**
- Go to your repository → Settings → Secrets and variables → Actions
- Click "New repository secret"
- Name: `DO_TOKEN` (exactly this name, case-sensitive)
- Value: Paste your full Digital Ocean API token

**Troubleshooting:**
- If you get "401 Unable to authenticate", check:
  1. The secret name is exactly `DO_TOKEN` (not `DO_TOKEN_` or `DIGITALOCEAN_TOKEN`)
  2. The token has "Write" scope (not Read-only)
  3. The token hasn't been revoked or expired
  4. You copied the entire token (no extra spaces before/after)

---

### 2. DOCKER_USERNAME (Required)
**What it is:** Docker Hub username for pushing images

**Set in GitHub:**
- Name: `DOCKER_USERNAME`
- Value: Your Docker Hub username

---

### 3. DOCKER_PASSWORD (Required)
**What it is:** Docker Hub password or access token

**How to get it:**
1. Go to https://hub.docker.com/settings/security
2. Create a new access token
3. Copy the token

**Set in GitHub:**
- Name: `DOCKER_PASSWORD`
- Value: Your Docker Hub password or access token

---

### 4. TMDB_API_READ_ACCESS_TOKEN (Required)
**What it is:** API token for The Movie Database API

**How to get it:**
1. Go to https://www.themoviedb.org/settings/api
2. Create an API key if you don't have one
3. Copy the "API Read Access Token"

**Set in GitHub:**
- Name: `TMDB_API_READ_ACCESS_TOKEN`
- Value: Your TMDB API token

---

### 5. TWILIO_ACCOUNT_SID (Required)
**What it is:** Twilio Account SID

**How to get it:**
1. Go to https://console.twilio.com/
2. Navigate to Account → Account Info
3. Copy the "Account SID"

**Set in GitHub:**
- Name: `TWILIO_ACCOUNT_SID`
- Value: Your Twilio Account SID

---

### 6. TWILIO_AUTH_TOKEN (Required)
**What it is:** Twilio Auth Token

**How to get it:**
1. Go to https://console.twilio.com/
2. Navigate to Account → Account Info
3. Copy the "Auth Token" (click to reveal)

**Set in GitHub:**
- Name: `TWILIO_AUTH_TOKEN`
- Value: Your Twilio Auth Token

---

### 7. TWILIO_SERVICE_SID (Required)
**What it is:** Twilio Service SID (for Verify service)

**How to get it:**
1. Go to https://console.twilio.com/
2. Navigate to Verify → Services
3. Select your service (or create one)
4. Copy the "Service SID"

**Set in GitHub:**
- Name: `TWILIO_SERVICE_SID`
- Value: Your Twilio Service SID

---

### 8. DEPLOY_DIR (Optional - defaults to '/opt/chrisvouga-dev')
**What it is:** Directory on the server where deployment files are stored

**Default value:** `/opt/chrisvouga-dev`

**Set in GitHub:**
- Name: `DEPLOY_DIR`
- Value: `/opt/chrisvouga-dev` (or your custom path)

---

## Optional GitHub Secrets

### DO_REGION (Optional)
**Default:** `nyc1`

**Available regions:**
- `nyc1`, `nyc3` - New York
- `sfo3` - San Francisco
- `ams3` - Amsterdam
- `sgp1` - Singapore
- `lon1` - London
- `fra1` - Frankfurt
- `tor1` - Toronto
- `blr1` - Bangalore

**Set in GitHub:**
- Name: `DO_REGION`
- Value: Your preferred region (e.g., `nyc1`)

---

### DO_DROPLET_SIZE (Optional)
**Default:** `s-2vcpu-4gb`

**Common sizes:**
- `s-1vcpu-1gb` - 1 vCPU, 1GB RAM (~$6/month)
- `s-2vcpu-2gb` - 2 vCPU, 2GB RAM (~$12/month)
- `s-2vcpu-4gb` - 2 vCPU, 4GB RAM (~$24/month) ⭐ Recommended
- `s-4vcpu-8gb` - 4 vCPU, 8GB RAM (~$48/month)

**Set in GitHub:**
- Name: `DO_DROPLET_SIZE`
- Value: Your preferred size (e.g., `s-2vcpu-4gb`)

---

### DO_ENABLE_RESERVED_IP (Optional)
**Default:** `true`

Set to `false` if you don't want a reserved IP (saves ~$4/month but IP changes if droplet is recreated).

**Set in GitHub:**
- Name: `DO_ENABLE_RESERVED_IP`
- Value: `true` or `false`

## Quick Setup Checklist

- [ ] Add all required secrets to GitHub repository:
  - [ ] `DO_TOKEN` - Digital Ocean API token
  - [ ] `DOCKER_USERNAME` - Docker Hub username
  - [ ] `DOCKER_PASSWORD` - Docker Hub password/token
  - [ ] `TMDB_API_READ_ACCESS_TOKEN` - TMDB API token
  - [ ] `TWILIO_ACCOUNT_SID` - Twilio Account SID
  - [ ] `TWILIO_AUTH_TOKEN` - Twilio Auth Token
  - [ ] `TWILIO_SERVICE_SID` - Twilio Service SID
- [ ] (Optional) Add optional secrets:
  - [ ] `DO_REGION` - Region (default: `nyc1`)
  - [ ] `DO_DROPLET_SIZE` - Droplet size (default: `s-2vcpu-4gb`)
  - [ ] `DO_ENABLE_RESERVED_IP` - Reserved IP (default: `true`)
- [ ] Push to `main` branch - GitHub Actions handles everything automatically!

**That's it!** No SSH keys to generate, no manual infrastructure setup, no local configuration needed.

## Using doctl for Quick Lookup

Install doctl: https://docs.digitalocean.com/reference/doctl/how-to/install/

```bash
# Authenticate
doctl auth init

# Get droplet IP quickly
doctl compute droplet list --format Name,PublicIPv4 --no-header | grep chrisvouga-dev | awk '{print $2}'

# Get all droplet info
doctl compute droplet get <DROPLET_ID> --format ID,Name,PublicIPv4,Status
```
