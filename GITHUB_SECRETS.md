# GitHub Secrets Configuration Guide

This guide explains how to obtain and configure the required GitHub Secrets for deployment.

**Note:** SSH keys are automatically generated by GitHub Actions - you don't need to create or manage them manually!

## Required GitHub Secrets

### 1. DO_TOKEN (Required)
**What it is:** Digital Ocean API token for provisioning infrastructure

**How to get it:**
1. Go to https://cloud.digitalocean.com/account/api/tokens
2. Click "Generate New Token"
3. Give it a name (e.g., "github-actions-terraform")
4. Select "Write" scope
5. Copy the token (you won't see it again!)

**Set in GitHub:**
- Go to your repository → Settings → Secrets and variables → Actions
- Click "New repository secret"
- Name: `DO_TOKEN`
- Value: Your Digital Ocean API token

---

### 2. DOCKER_USERNAME (Required)
**What it is:** Docker Hub username for pushing images

**Set in GitHub:**
- Name: `DOCKER_USERNAME`
- Value: Your Docker Hub username

---

### 3. DOCKER_PASSWORD (Required)
**What it is:** Docker Hub password or access token

**How to get it:**
1. Go to https://hub.docker.com/settings/security
2. Create a new access token
3. Copy the token

**Set in GitHub:**
- Name: `DOCKER_PASSWORD`
- Value: Your Docker Hub password or access token

---

### 4. TMDB_API_READ_ACCESS_TOKEN (Required)
**What it is:** API token for The Movie Database API

**How to get it:**
1. Go to https://www.themoviedb.org/settings/api
2. Create an API key if you don't have one
3. Copy the "API Read Access Token"

**Set in GitHub:**
- Name: `TMDB_API_READ_ACCESS_TOKEN`
- Value: Your TMDB API token

---

### 5. TWILIO_ACCOUNT_SID (Required)
**What it is:** Twilio Account SID

**How to get it:**
1. Go to https://console.twilio.com/
2. Navigate to Account → Account Info
3. Copy the "Account SID"

**Set in GitHub:**
- Name: `TWILIO_ACCOUNT_SID`
- Value: Your Twilio Account SID

---

### 6. TWILIO_AUTH_TOKEN (Required)
**What it is:** Twilio Auth Token

**How to get it:**
1. Go to https://console.twilio.com/
2. Navigate to Account → Account Info
3. Copy the "Auth Token" (click to reveal)

**Set in GitHub:**
- Name: `TWILIO_AUTH_TOKEN`
- Value: Your Twilio Auth Token

---

### 7. TWILIO_SERVICE_SID (Required)
**What it is:** Twilio Service SID (for Verify service)

**How to get it:**
1. Go to https://console.twilio.com/
2. Navigate to Verify → Services
3. Select your service (or create one)
4. Copy the "Service SID"

**Set in GitHub:**
- Name: `TWILIO_SERVICE_SID`
- Value: Your Twilio Service SID

---

### 8. DEPLOY_DIR (Optional - defaults to '/opt/chrisvouga-dev')
**What it is:** Directory on the server where deployment files are stored

**Default value:** `/opt/chrisvouga-dev`

**Set in GitHub:**
- Name: `DEPLOY_DIR`
- Value: `/opt/chrisvouga-dev` (or your custom path)

---

## Quick Setup Checklist

- [ ] Generate SSH key pair (`ssh-keygen`)
- [ ] Add public key to Digital Ocean (via Terraform, doctl, or web console)
- [ ] Provision infrastructure with Terraform
- [ ] Get droplet IP from Terraform output or doctl
- [ ] Add all secrets to GitHub repository:
  - [ ] `DO_HOST` - Droplet IP address
  - [ ] `DO_USER` - SSH user (default: `root`)
  - [ ] `DO_SSH_KEY` - Private SSH key
  - [ ] `TMDB_API_READ_ACCESS_TOKEN` - TMDB API token
  - [ ] `TWILIO_ACCOUNT_SID` - Twilio Account SID
  - [ ] `TWILIO_AUTH_TOKEN` - Twilio Auth Token
  - [ ] `TWILIO_SERVICE_SID` - Twilio Service SID
  - [ ] `DEPLOY_DIR` - (optional) Deployment directory

## Testing SSH Connection

Before setting up GitHub Actions, test your SSH connection:

```bash
# Test SSH connection
ssh -i ~/.ssh/do_deploy_key root@<DROPLET_IP>

# Or if using default key
ssh root@<DROPLET_IP>
```

If connection works, you're ready to deploy!

## Using doctl for Quick Lookup

Install doctl: https://docs.digitalocean.com/reference/doctl/how-to/install/

```bash
# Authenticate
doctl auth init

# Get droplet IP quickly
doctl compute droplet list --format Name,PublicIPv4 --no-header | grep chrisvouga-dev | awk '{print $2}'

# Get all droplet info
doctl compute droplet get <DROPLET_ID> --format ID,Name,PublicIPv4,Status
```
